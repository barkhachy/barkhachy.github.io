
    <html>
        <title>Cart</title>
        <head>
            <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
            <style>
                * {
    box-sizing: border-box;
    }
    
    *:focus {
    outline: none;
    }
    body {
    font-family: Arial;
    background-color: #3498DB;
    padding: 50px;
    }
    .login {
    margin: 20px auto;
    width: 300px;
    }
    .login-screen {
    background-color: #FFF;
    padding: 20px;
    border-radius: 5px
    }
    
    .app-title {
    text-align: center;
    color: #777;
    }
    .login-form {
    text-align: center;
    }
    .control-group {
    margin-bottom: 10px;
    }
    .checkout{
        margin: 20px auto;
        width: 300px;
    }
    .checkout-screen {
        background-color: #FFF;
        padding: 20px;
        border-radius: 5px
    } 
    .checkout-form {
     text-align: center;
    }

    input {
    text-align: center;
    background-color: #ECF0F1;
    border: 2px solid transparent;
    border-radius: 3px;
    font-size: 16px;
    font-weight: 200;
    padding: 10px 0;
    width: 250px;
    transition: border .5s;
    }
    
    input:focus {
    border: 2px solid #3498DB;
    box-shadow: none;
    }
    
    .btn {
    border: 2px solid transparent;
    background: #3498DB;
    color: #ffffff;
    font-size: 16px;
    line-height: 25px;
    padding: 10px 0;
    text-decoration: none;
    text-shadow: none;
    border-radius: 3px;
    box-shadow: none;
    transition: 0.25s;
    display: block;
    width: 250px;
    margin: 0 auto;
    }
    
    .btn:hover {
    background-color: #2980B9;
    }
    
    .login-link {
    font-size: 12px;
    color: #444;
    display: block;
    margin-top: 12px;
    }
            </style>
           
        </head>
        <body>
            <form name = "Checkout_form" method="POST">
            <div class="checkout">
            <div class="checkout-screen">
            <div class="app-title">
            <h1>Enter details</h1>
            </div>
            <div class="checkout-form">
            <div class="control-group">
                    <input type="text" class="checkout-field" value="" placeholder="First Name" name="f_name" id = "f_name" required>  
                    <label class="login-field-icon fui-user" for="f_name"></label>
            </div>
            <div class="control-group">
                    <input type="text" class="checkout-field" value="" placeholder="Last Name" name="l_name" id= "l_name" required>
                    <label class="login-field-icon fui-user" for="l_name"></label>
            </div>
            <div class="control-group">
                <input type="mail" class="checkout-field" value="" placeholder="Email" name="mail" id ="mail" required>  
                <label class="login-field-icon fui-user" for="f_name"></label>
            </div>
            <div class="control-group">
                <input type="number" class="checkout-field" value="" placeholder="Phone Number" name="phone" id = "phone" required>
                <label class="login-field-icon fui-user" for="l_name"></label>
            </div>
            <div class="control-group">
                <input type="date" class="checkout-field" value="" placeholder="" name="dob" id = "dob" required>
                <label class="login-field-icon fui-lock" for="login-pass"></label>
            </div>
            <div class="app-title"><label>Address Details</label></div>
            <div class="control-group">
                <input type="text" class="checkout-field" value="" placeholder="Street" name="street_1" id = "street_1" required>  
                <label class="login-field-icon fui-user" for="f_name"></label>
            </div>
            <div class="control-group">
                <input type="text" class="checkout-field" value="" placeholder="Street 2" name="street_2" id = "street_2" required>
                <label class="login-field-icon fui-user" for="l_name"></label>
            </div>
            <div class="control-group">
                <input type="text" class="checkout-field" value="" placeholder="city" name="city" id = "city" required>  
                <label class="login-field-icon fui-user" for="f_name"></label>
            </div>
            <div class="control-group">
                <input type="number" class="checkout-field" value="" placeholder="Zip" name="zip" id = "zip" required>
                <label class="login-field-icon fui-user" for="l_name"></label>
            </div>
            <div class="control-group">
                <input type="text" class="checkout-field" value="" placeholder="State {For Maharashtra type MH}" name="state" id = "state" required>
                <label class="login-field-icon fui-user" for="l_name"></label>
            </div>
            <div class="control-group">
                <input type="text" class="checkout-field" value="" placeholder="Country {For India type IN}" name="country" id = "country" required>
                <label class="login-field-icon fui-user" for="l_name"></label>
            </div>
            <input type="button" onclick="checkout()" value="Proceed" class="btn btn-primary btn-large btn-block"/>
            </div>
            </div>
            </div>
            </form>
            <script src="https://hosted.paysafe.com/checkout/v2/paysafe.checkout.min.js"></script>
            <script type="text/javascript" charset="utf-8">
    
            function checkout()
            {
                 
                merchantRefNum = Math.random().toString(36).slice(5);
                var f_name = document.getElementById('f_name').value;
                var l_name = document.getElementById('l_name').value;
                var mail = document.getElementById('mail').value;
                var phone = document.getElementById('phone').value;
                var dob = document.getElementById('dob').value;
                var street_1 = document.getElementById('street_1').value;
                var street_2 = document.getElementById('street_2').value;
                var zip = document.getElementById('zip').value;
                var city = document.getElementById('city').value;
                var state = document.getElementById('state').value;
                var country = document.getElementById('country').value;
                console.log(merchantRefNum)
                console.log(mail)
                first_dict = 
                {
                                    "f_name" : f_name,
                                    "l_name" : l_name,
                                    "mail" : mail,
                                    "phone" :phone,
                                    "dob" : dob,
                                    "street_1" : street_1,
                                    "street_2": street_2,
                                    "zip":zip,
                                    "city":city,
                                    "state" : state,
                                    "country":country,
                                    "merchantRefNum": merchantRefNum,
                }
                try{
                        $.ajax({
                                type: "POST",
                                url: "https://bcpjxx2pjl.execute-api.us-east-2.amazonaws.com/testing/token",
                                data: JSON.stringify(first_dict),
                                crossDomain: true,
                                dataType: "json",
                                contentType: "application/json",
                                success: function(response) 
                                {
                                    console.log(response)  
                                                            id = response['singleUseCustomerToken'];
                                                            console.log(id)
                                                            merchant = {
                                                                    "dynamicDescriptor":response['m_description'],
                                                                    "phone":response['m_phone']
                                                            }
                                                            console.log(merchant)
                                                            //date = "{{dob['day']}}"
                                                            //console.log(type(date))
                                                            dict ={
                                                            "currency": response['currency'],
                                                            "amount": 5000,
                                                            "locale": response['locale'],
                                                            "customer":
                                                            {
                                                                "firstName":f_name,
                                                                "lastName":l_name,
                                                                "email":mail,
                                                                "phone":phone,
                                                                "dateOfBirth":
                                                                {
                                                                    "day": 10,
                                                                    "month":10,////"{{dob['month']}}",
                                                                    "year":1980//{{dob['year']}}"
                                                                },
                                                            },
                                                            "billingAddress":{
                                                                "nickName": f_name + l_name,
                                                                "street":street_1,
                                                                "street2":street_2,
                                                                "city":city,
                                                                "zip":zip,
                                                                "country":country,
                                                                "state":state
                                                            },
                                                            "environment":response['environemnt'],
                                                            "merchantRefNum":merchantRefNum,
                                                            "canEditAmount":false,
                                                            "merchantDescriptor":merchant,
                                                            "displayPaymentMethods":["card"],
                                                            "paymentMethodDetails": {
                                                                    "paysafecard": {
                                                                        "consumerId": "1232323"
                                                                    },
                                                                }
                                                            }
                                                            dict['singleUseCustomerToken']=response['singleUseCustomerToken']
                                                            console.log(dict)
                                                            paysafe.checkout.setup(response['config'],dict
                                                            ,function(instance, error, result) {
                                                                if (result && result.paymentHandleToken && result.customerOperation == 'ADD') {
                                                                    try {
                                                                        //pass customer Id to backend when customer waants to save card
                                                                            s_data ={ "customerId": response['customer_id'],
                                                                                        "merchantRefNum": merchantRefNum,
                                                                                        "paymentHandleToken": result.paymentHandleToken,
                                                                                        "amount": result.amount
                                                                            }
                                                                            $.ajax({
                                                                                    type: "POST",
                                                                                    url: "https://bcpjxx2pjl.execute-api.us-east-2.amazonaws.com/testing/save_card",
                                                                                    data: JSON.stringify(s_data),
                                                                                    dataType: "json",
                                                                                    contentType : "application/json",
                                                                                    crossDomain: true,
                                                                                    success: function(response) {
                                                                                        str = response['id']
                                                                                        console.log(str)
                                                                                        console.log(response)
                                                                                        instance.showSuccessScreen(`Payment ID: ${str}`);
                                                                                    },
                                                                                    error: function(err) {
                                                                                        console.log(err);
                                                                                    }
                                                                                    });
                                                                            //console.log(response)
                                                                            
                                                                            //instance.showSuccessScreen(`Payment ID: ${obj}`);
                                                                        } catch (err) {
                                                                            instance.showFailureScreen("Payment Failed! Please Try Again.");
                                                                            throw err;
                                                                        }
                                                                    // make AJAX call to Payments API
                                                                } 
                                                                else if (result && result.paymentHandleToken && result.customerOperation != 'ADD') {
                                                                    try {
                                                                        s_data ={ 
                                                                                        "merchantRefNum": merchantRefNum,
                                                                                        "paymentHandleToken": result.paymentHandleToken,
                                                                                        "amount": result.amount
                                                                                }
                                                                        //pass customer Id to backend when customer waants to save card
                                                                            $.ajax({
                                                                                    type: "POST",
                                                                                    url: "https://bcpjxx2pjl.execute-api.us-east-2.amazonaws.com/testing/save_card",
                                                                                    data: JSON.stringify(s_data),
                                                                                    dataType: "json",
                                                                                    contentType : "application/json",
                                                                                    success: function(response) {
                                                                                        str = response['id']
                                                                                        console.log(str)
                                                                                        //console.log(response)
                                                                                        instance.showSuccessScreen(`Payment ID: ${str}`);
                                                                                    },
                                                                                    error: function(err) {
                                                                                        console.log(err);
                                                                                    }
                                                                                    });
                                                                            
                                                                        } catch (err) {
                                                                            instance.showFailureScreen("Payment Failed! Please Try Again.");
                                                                            throw err;
                                                                        }
                                                                        }else {
                                                                    console.log(error);
                                                                    alert(error);
                                                                    //window.open("/payment_unsucessful/","_self");
                                                                    // Handle the error
                                                                }
                                                            }, function(stage, expired) {
                                                                switch(stage) {
                                                                    case "PAYMENT_HANDLE_NOT_CREATED": 
                                                                    // Handle the scenario
                                                                    instance.showFailureScreen("Payment Handle Not created!!")
                                                                    //window.open("/payment_handle_not_created/","_self");default: // Handle the scenario
                                                                }
                                                            });
                                                        },
                                                        error: function(err) {
                                                            console.log(err);
                                                        }
                                                        });
                            
                        }
                        catch(err)
                        {
                            console.log(err)
                        }
                        }
                </script>
            
          
        </body>
    </html>